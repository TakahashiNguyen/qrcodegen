import{w as ae,v as re,a as se,c as ie}from"./vue_runtime-dom-Bqn1r05j.js";import{i as ue,C as de}from"./flowbite-BK3zwtRc.js";import{R as ce,c as me,a as fe}from"./vue-router-BeosvJ7G.js";import{d as R,o as Z,e as Q,f as d,j as f,k as i,l as p,m as V,r as ee,q as U,s as w,t as z,h as pe,b as K,w as ge,u as he,v as te,x as oe,y as ne,F as ve,z as ye,A as be,B as we}from"./vue_runtime-core-CbwMzOXN.js";import{x as W,y as m,g as xe}from"./vue_reactivity-C1Gw_TzD.js";import{K as j,p as E,L as ke,q as Ce}from"./vue_shared-CljFMYtq.js";import{u as $e}from"./vueuse_core-Cd5FfhXZ.js";import{j as _e}from"./jsqr-D6czZR4y.js";import{Q as Le}from"./qrcode-9ot_T-Z6.js";import"./popperjs_core-DC5wud4b.js";import"./flowbite-datepicker-BdtIV8Rz.js";import"./vueuse_shared-xNM46b15.js";import"./dijkstrajs-B-FHFk8B.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList")for(const l of u.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const u={};return s.integrity&&(u.integrity=s.integrity),s.referrerPolicy&&(u.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?u.credentials="include":s.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(s){if(s.ep)return;s.ep=!0;const u=n(s);fetch(s.href,u)}})();const Ve=R({__name:"App",setup(e){return Z(()=>{ue()}),(t,n)=>(d(),Q(W(ce)))}}),Y=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},Re={},Se={class:"center h-dvh w-dvw font-mono"},Ee={class:"bg--0 flex flex-col items-center rounded-3xl p-10"};function Ne(e,t){const n=ee("router-link");return d(),f("div",Se,[i("div",Ee,[t[1]||(t[1]=i("h1",{class:"text-9xl"},"Xin chào",-1)),p(n,{class:"link w-fit font-sans",to:"/qr-contact"},{default:V(()=>[...t[0]||(t[0]=[U("Tạo mã QR lưu danh bạ",-1)])]),_:1})])])}const qe=Y(Re,[["render",Ne]]),Pe={},Me={class:"center h-dvh w-dvw font-mono"},Te={class:"bg--0 flex flex-row items-center rounded-3xl p-10"},De={class:"flex flex-col"};function Be(e,t){const n=ee("router-link");return d(),f("div",Me,[i("div",Te,[t[2]||(t[2]=i("h1",{class:"text-9xl"},"404!",-1)),i("div",De,[t[1]||(t[1]=i("a",null,"Trang này chưa tồn tại hoặc có thể đã bị xóa.",-1)),p(n,{class:"link w-fit font-sans",to:"/"},{default:V(()=>[...t[0]||(t[0]=[U("Về trang chủ",-1)])]),_:1})])])])}const Ie=Y(Pe,[["render",Be]]),je=R({props:{name:{type:String,required:!0}}}),Fe={class:"material-symbols-outlined aspect-square"};function Ue(e,t,n,r,s,u){return d(),f("span",Fe,j(e.name),1)}const le=Y(je,[["render",Ue]]),Ae={class:"p-1"},Oe=["type","disabled"],ze={key:1,class:"inset-y-0 start-0 flex items-center justify-center-safe"},H=R({__name:"Button",props:{type:{type:String,default:"button"},theme:{type:String,default:"primary"},buttonRef:{type:Function,required:!1},to:{type:String,required:!1}},setup(e,{expose:t}){const n=m(!1);return t({toggleLoading:()=>n.value=!n.value}),(r,s)=>(d(),f("div",Ae,[e.type!=="link"?(d(),f("button",{key:0,title:"",ref:e.buttonRef,type:e.type,class:E(["w-full rounded-lg px-5 py-2.5 text-center text-sm font-medium",{"text--primary bg--primary hover:text--secondary hover:bg--secondary disabled:bg--secondary disabled:text--secondary":e.theme=="primary","text--tertiary hover:bg--tertiary hover:-text--2":e.theme=="secondary"}]),disabled:n.value},[n.value?w("",!0):z(r.$slots,"default",{key:0}),n.value?(d(),f("div",ze,[p(le,{name:"progress_activity",class:"animate-spin"})])):w("",!0)],10,Oe)):w("",!0),e.type==="link"?(d(),f("a",{key:1,class:"link",href:"#",onClick:s[0]||(s[0]=u=>e.to?r.$router.push({name:e.to}):"")},[z(r.$slots,"default")])):w("",!0)]))}});function X(e){return t=>{e.value=t}}function He(){return new Promise(e=>{document.readyState==="complete"?e():window.addEventListener("load",()=>e(),{once:!0})})}function J(e){return new Promise(t=>setTimeout(t,e))}function G(e){const t=[];for(const n of e)if(n.key==="_content"&&n.children&&Array.isArray(n.children))t.push(...G(n.children));else{const r={...n};n.children&&Array.isArray(n.children)&&(r.children=G(n.children)),t.push(r)}return t}const Qe=R({inheritAttrs:!1,setup({},{slots:e,attrs:t}){return()=>G(e.default?.()).map(n=>pe("div",{class:["bg--0","h-fit","flex",t.class]},[n]))}}),We=R({__name:"LoadingDiv",setup(e,{expose:t}){const n=m(!1);function r(){n.value=!n.value}return t({toggleHidden:r}),(s,u)=>(d(),f("div",{class:E(["h-full w-full bg-white dark:bg-black",{hidden:n.value}])},[...u[0]||(u[0]=[i("div",{class:"h-full w-full animate-pulse bg-black/10 dark:bg-white/10"},null,-1)])],2))}}),Ke={key:0,class:"[&>*]:z-[45]"},Ge={key:1,class:"[&>*]:absolute [&>*]:z-[45]"},Ye=R({__name:"Carousel",props:{isCycle:{type:Boolean,default:!1},overflowing:{type:Boolean,default:!1},duration:{type:Number,default:500},cycleDuration:{type:Number,default:3e3},indicator:{type:Object,default:{activeClasses:"bg-white dark:bg-white/80",inactiveClasses:"bg-white/50 dark:bg-white/40 hover:bg-white/90 dark:hover:bg-white/70"}},indicatorsLocation:{type:[String,Object,Array],default:"bottom-5 left-1/2 -translate-x-1/2"}},setup(e,{expose:t}){const n=m(),r=m(),s=m(),u=m(),l=m(),v=m(),P=X(u),x=X(l),N=m(),M=m(0),T=m(),A=K(()=>M.value==1),O=K(()=>M.value==r.value?.childElementCount),C=e;class F extends de{async _rotate(y){Object.values(y).forEach(c=>{c.el.classList.remove("hidden")}),await J(1),super._rotate(y),M.value=y.middle.position+1,T.value=y.middle.el,await J(C.duration),y.left.el.classList.add("hidden"),y.right.el.classList.add("hidden")}}return Z(async()=>{const $=Array.from(r.value.children).map((o,a)=>({position:a,el:o})),y=$.map(()=>{const o=document.createElement("button");return o.className="h-3 w-3 rounded-full",o.type="button",o.title="",s.value?.append(o),o}),c={defaultPosition:0,interval:C.cycleDuration,indicators:{...C.indicator,items:Array.from(y).map((o,a)=>({position:a,el:o}))}};ge($e(T).height,o=>{n.value.style.height=r.value.style.height=o.toString()+"px"}),await He(),v.value=new F(n.value,$,c,{}),C.isCycle&&v.value.cycle(),l.value?.addEventListener("click",()=>{(!A.value||C.overflowing||C.isCycle)&&v.value?.prev()}),u.value?.addEventListener("click",()=>{(!O.value||C.overflowing||C.isCycle)&&v.value?.next()}),N.value?.toggleHidden()}),t({next:()=>v.value?.next(),previous:()=>v.value?.prev()}),($,y)=>(d(),f("div",{ref_key:"carouselElement",ref:n,class:"relative w-full",style:Ce({"--duration":e.duration+"ms"})},[p(We,{ref_key:"loadingDiv",ref:N,class:"absolute z-40"},null,512),i("div",{ref_key:"carouselWrapper",ref:r,class:"relative h-56 overflow-hidden [&>*]:absolute! [&>*]:w-full [&>*]:duration-(--duration) [&>*]:ease-in-out"},[p(Qe,ke(he($.$attrs)),{default:V(()=>[z($.$slots,"content")]),_:3},16)],512),i("div",{class:E([[e.indicatorsLocation],"absolute z-50 flex space-x-3"]),ref_key:"carouselIndicatorsWrapper",ref:s},null,2),$.$slots.buttons?w("",!0):(d(),f("div",Ke,[i("button",{title:"previous",ref_key:"carouselPrevious",ref:l,type:"button",class:E(["group absolute top-0 left-0 flex h-full cursor-pointer items-center justify-center px-4 focus:outline-none",{hidden:!e.overflowing&&!e.isCycle&&A.value}])},[...y[0]||(y[0]=[i("span",{class:"inline-flex h-10 w-10 items-center justify-center rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none dark:bg-gray-800/30 dark:group-hover:bg-gray-800/60 dark:group-focus:ring-gray-800/70"},[i("svg",{class:"h-4 w-4 text-white dark:text-gray-800","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 6 10"},[i("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 1 1 5l4 4"})])],-1)])],2),i("button",{title:"next",ref_key:"carouselNext",ref:u,type:"button",class:E(["group absolute top-0 right-0 flex h-full cursor-pointer items-center justify-center px-4 focus:outline-none",{hidden:!e.overflowing&&!e.isCycle&&O.value}])},[...y[1]||(y[1]=[i("span",{class:"inline-flex h-10 w-10 items-center justify-center rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none dark:bg-gray-800/30 dark:group-hover:bg-gray-800/60 dark:group-focus:ring-gray-800/70"},[i("svg",{class:"h-4 w-4 text-white dark:text-gray-800","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 6 10"},[i("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 9 4-4-4-4"})])],-1)])],2)])),$.$slots.buttons?(d(),f("div",Ge,[z($.$slots,"buttons",{next:W(P),previous:W(x),isEnd:O.value,isStart:A.value})])):w("",!0)],4))}}),Xe={class:"center h-dvh"},Je={class:"bg--0 tablet:w-lg desktop:w-4xl desktop:min-h-auto tablet:min-h-auto flex h-fit min-h-dvh w-dvw items-center rounded-lg p-8"},Ze={key:0,class:"text-3xl font-medium"},et={class:"desktop:w-md w-full space-y-6"},tt=R({__name:"FormContainer",props:{title:{},buttonHandler:{type:Function}},setup(e){return(t,n)=>(d(),f("div",Xe,[i("div",Je,[i("form",{class:"desktop:flex-row desktop:justify-between flex size-full flex-col justify-center-safe space-y-6",onSubmit:n[0]||(n[0]=ae((...r)=>t.buttonHandler&&t.buttonHandler(...r),["prevent"]))},[t.title?(d(),f("h5",Ze,j(t.title),1)):w("",!0),i("div",et,[z(t.$slots,"default")])],32)])]))}}),ot={class:"text--primary bg--0 flex w-full flex-col p-1"},nt={class:"bg--0 z-1 -mb-2 ml-2 block w-fit text-sm font-medium"},lt=["value"],at=R({__name:"SelectInput",props:te({name:{},list:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=oe(e,"modelValue");return(n,r)=>(d(),f("div",ot,[i("label",nt,j(n.name),1),ne(i("select",{class:"border--primary bg--0 text--0 w-full rounded-lg border p-2.5","onUpdate:modelValue":r[0]||(r[0]=s=>t.value=s)},[(d(!0),f(ve,null,ye(n.list,s=>(d(),f("option",{key:s[0],value:s[1]},j(s[0]),9,lt))),128))],512),[[re,t.value]])]))}}),rt={class:"text--primary bg--0 flex w-full flex-col p-1"},st={class:"bg--0 z-1 -mb-2 ml-2 block w-fit text-sm font-medium"},it={class:"relative z-0"},ut={key:0,class:"pointer-events-none absolute inset-y-0 start-0 flex items-center px-[9px]"},dt={class:"flex justify-center"},ct=["type","disabled","placeholder","multiple","id"],mt={key:0,class:"border--primary text--0 h-10 w-full rounded-l-lg border border-r-0 p-2 overflow-hidden"},q=R({__name:"TextInput",props:te({name:{type:String,required:!0},type:{type:String,default:"text"},icon:{type:String,required:!1},placeholder:{type:String,required:!1},disabled:{type:Boolean,required:!1},accept:{type:String,default:""},multiple:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=oe(e,"modelValue"),n=be(),r=m("Chưa có tập tin"),s=e,u=K(()=>({accept:s.accept||void 0})),l=P=>{const x=P.target.files;x&&x.length>0?r.value=s.multiple?x.length+" tập tin":x[0].name:r.value="No file selected"},v=()=>{document.getElementById(n)?.click()};return(P,x)=>(d(),f("div",rt,[i("label",st,j(e.name),1),i("div",it,[e.icon?(d(),f("div",ut,[p(le,{name:e.icon.toLowerCase()},null,8,["name"])])):w("",!0),i("div",dt,[ne(i("input",we({title:"","onUpdate:modelValue":x[0]||(x[0]=N=>t.value=N),class:["border--primary bg--0 text--0 h-10 w-full rounded-lg border p-2",{"ps-10!":e.icon,hidden:e.type=="file"}],type:e.type,disabled:e.disabled,placeholder:e.placeholder,multiple:e.multiple},u.value,{id:W(n),onchange:l}),null,16,ct),[[se,t.value]]),e.type=="file"?(d(),f("span",mt,j(r.value),1)):w("",!0),e.type=="file"?(d(),f("button",{key:1,type:"button",class:"border--primary bg--primary hover:bg--secondary flex h-auto items-center rounded-r-lg border px-4",onclick:v}," Duyệt ")):w("",!0)])])]))}}),ft={class:"right-0 -bottom-15 flex h-8 w-fit items-center justify-center [&>*]:ml-2"},pt={class:"w-full space-y-6"},gt={key:2},ht={class:"text-error"},vt={class:"aspect-square w-full"},yt=R({__name:"QrGenerator",setup(e){const t=m(),n=m(new Map),r=4096,s=m(""),u=m(),l=xe({name:"Phòng Công tác học sinh - sinh viên",email:"phongctct-hssv@tdtu.edu.vn",phone:"02837755054",roomNumber:"A0003",pageLink:"fb.com/pcthssv.tdtu",logoScale:1,errorCorrectionLevel:"L",logoRotation:0}),v=m(),P=m(),x=m(),N=m(),M=m(),T=m(""),A=async()=>{t.value.toBlob(c=>{if(!c)return;const o=URL.createObjectURL(c),a=document.createElement("a");a.href=o,a.download=l.name+".png",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},"image/png")},O=async()=>{M.value?.toggleLoading();const c=await C(),o=async()=>{const _=I=>(l.logoScale=I,u.value.putImageData(c,0,0),F(!0)),h=Math.pow(10,1),{width:b,height:B}=P.value;let L=0,S=Math.floor(1*r/Math.max(b,B)*h);for(;L<=S;){const I=Math.floor((L+S)/2);await _(I/h)?L=I+1:S=I-1}return Math.floor((L+S)/2)/h},a=async()=>{l.logoRotation=0;let _=await o(),D=0;for(let h=90;h<360;h+=90){l.logoRotation=h;const b=await o();b>_&&(D=h,_=b)}return{scale:_,rotate:D}},{scale:k,rotate:g}=await a();l.logoScale=k,l.logoRotation=g,u.value.putImageData(c,0,0),await F(!1),M.value?.toggleLoading()},C=async()=>{function c(){const{name:k,phone:g,email:_,roomNumber:D,pageLink:h}=l,b=k,B="",L="",S=[b,B,L,"",""].join(";"),I=`${b} ${L} ${B}`.trim();return{qrContact:`
BEGIN:VCARD
VERSION:3.0
N:${S}
FN:${I}
TEL;TYPE=cell:${g}
EMAIL;INTERNET;PREF:${_}
ADR;TYPE=WORK;PREF=1;LABEL="":;Trường Đại học Tôn Đức Thắng;Phòng ${D};phường Tân Phong;19 Nguyễn Hữu Thọ;Thành phố Hồ Chí Minh;Việt Nam
URL:${h}
END:VCARD
  `.trim(),qrPhone:`MECARD:TEL:${g};;`}}const{qrContact:o}=c(),a={margin:5,width:r,errorCorrectionLevel:l.errorCorrectionLevel};return s.value=o,await Le.toCanvas(t.value,o,a),u.value=t.value.getContext("2d",{willReadFrequently:!0}),u.value.getImageData(0,0,r,r)},F=async(c=!1)=>{T.value="",typeof c!="boolean"&&(c=!1),c||(N.value?.toggleLoading(),await C()),await v.value?.();try{const{data:o}=_e(u.value.getImageData(0,0,r,r).data,r,r);if(o!==s.value)throw new Error;if(c)return!0;t.value.style.rotate=`-${l.logoRotation}deg`,x.value?.next()}catch{if(c)return!1;T.value="Logo quá lớn, không thể nhận dạng."}return N.value?.toggleLoading(),!1};async function $(c){const o=c.target;if(o.files&&o.files[0]){const a=o.files[0];P.value=await y(a),v.value=async()=>new Promise((k,g)=>{const _=new FileReader;_.onload=D=>{const h=new Image;h.onload=()=>{if(t.value){const b=u.value,B=t.value,L=h.width*l.logoScale,S=h.height*l.logoScale;b&&(b.save(),b.translate(B.width/2,B.height/2),b.rotate(l.logoRotation/180*Math.PI),b.drawImage(h,-L/2,-S/2,L,S),b.restore(),k()),g("Canvas not found")}g("Invalid QR content")},h.src=D.target?.result},_.readAsDataURL(a)})}else v.value=void 0}function y(c){return new Promise((o,a)=>{const k=new FileReader;k.onload=()=>{const g=new Image;g.onload=()=>{o({width:g.width,height:g.height})},g.onerror=()=>{a(new Error("Unable to load image."))},g.src=k.result},k.onerror=()=>{a(new Error("Error reading file."))},k.readAsDataURL(c)})}return n.value.set("Cao","H"),n.value.set("Trung bình","M"),n.value.set("Thấp","L"),(c,o)=>(d(),Q(tt,{"button-handler":F,title:"Tạo QR lưu danh bạ"},{default:V(()=>[p(Ye,{"indicators-location":"-bottom-15 p-1 hidden",indicator:{activeClasses:"bg-light-primary/90",inactiveClasses:"bg-light-primary/50 hover:bg-light-primary/70"},class:"mb-20 min-h-30",ref_key:"carousel",ref:x},{buttons:V(({isEnd:a,previous:k,isStart:g})=>[i("div",ft,[p(H,{theme:"secondary",class:E({hidden:v.value==null||a}),onclick:O,ref_key:"autoAlignLogoButton",ref:M},{default:V(()=>[...o[8]||(o[8]=[U(" Tự động căn chỉnh logo ",-1)])]),_:1},8,["class"]),p(H,{"button-ref":k,theme:"secondary",class:E({hidden:g})},{default:V(()=>[...o[9]||(o[9]=[U(" Trở về ",-1)])]),_:1},8,["button-ref","class"]),p(H,{ref_key:"submitButton",ref:N,class:E({hidden:a}),onclick:F},{default:V(()=>[...o[10]||(o[10]=[U(" Hoàn tất ",-1)])]),_:1},8,["class"]),p(H,{class:E({hidden:g}),onclick:A},{default:V(()=>[...o[11]||(o[11]=[U(" Tải ảnh ",-1)])]),_:1},8,["class"])])]),content:V(()=>[i("div",pt,[p(q,{name:"Họ và tên",modelValue:l.name,"onUpdate:modelValue":o[0]||(o[0]=a=>l.name=a)},null,8,["modelValue"]),p(q,{name:"Số điện thoại",modelValue:l.phone,"onUpdate:modelValue":o[1]||(o[1]=a=>l.phone=a)},null,8,["modelValue"]),p(q,{name:"Địa chỉ thư điện tử",modelValue:l.email,"onUpdate:modelValue":o[2]||(o[2]=a=>l.email=a)},null,8,["modelValue"]),p(q,{name:"Số phòng",modelValue:l.roomNumber,"onUpdate:modelValue":o[3]||(o[3]=a=>l.roomNumber=a)},null,8,["modelValue"]),p(q,{name:"Link pageLink fanpage",modelValue:l.pageLink,"onUpdate:modelValue":o[4]||(o[4]=a=>l.pageLink=a)},null,8,["modelValue"]),p(at,{name:"Cấp độ (càng cao, mã QR càng chi tiết)",list:n.value,modelValue:l.errorCorrectionLevel,"onUpdate:modelValue":o[5]||(o[5]=a=>l.errorCorrectionLevel=a)},null,8,["list","modelValue"]),p(q,{type:"file",onChange:$,accept:"image/*",name:"Ảnh logo"}),v.value?(d(),Q(q,{key:0,name:"Tỉ lệ logo so với gốc",modelValue:l.logoScale,"onUpdate:modelValue":o[6]||(o[6]=a=>l.logoScale=a)},null,8,["modelValue"])):w("",!0),v.value?(d(),Q(q,{key:1,name:"Độ lớn góc xoay mã QR",modelValue:l.logoRotation,"onUpdate:modelValue":o[7]||(o[7]=a=>l.logoRotation=a),"default-value":"0"},null,8,["modelValue"])):w("",!0),T.value?(d(),f("div",gt,[i("a",ht,j(T.value),1)])):w("",!0)]),i("div",vt,[i("canvas",{ref_key:"qrCode",ref:t,class:"!size-full"},null,512)])]),_:1},512)]),_:1}))}}),bt=me({history:fe("/qrcodegen/"),routes:[{path:"/",component:qe},{path:"/qr-contact",component:yt},{path:"/:pathMatch(.*)*",component:Ie}]});ie(Ve).use(bt).mount("#app");
